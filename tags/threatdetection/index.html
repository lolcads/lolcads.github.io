<!doctype html><html lang=en>
<head>
<title>ThreatDetection :: lolcads tech blog</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=keywords content="TODO">
<meta name=robots content="noodp">
<link rel=canonical href=https://lolcads.github.io/tags/threatdetection/>
<link rel=stylesheet href=https://lolcads.github.io/assets/style.css>
<link rel=stylesheet href=https://lolcads.github.io/assets/green.css>
<link rel=apple-touch-icon href=https://lolcads.github.io/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=https://lolcads.github.io/img/favicon/green.png>
<meta name=twitter:card content="summary">
<meta property="og:locale" content="en">
<meta property="og:type" content="website">
<meta property="og:title" content="ThreatDetection">
<meta property="og:description" content>
<meta property="og:url" content="https://lolcads.github.io/tags/threatdetection/">
<meta property="og:site_name" content="lolcads tech blog">
<meta property="og:image" content="https://lolcads.github.io/img/favicon/green.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<link href=/tags/threatdetection/index.xml rel=alternate type=application/rss+xml title="lolcads tech blog">
</head>
<body class=green>
<div class="container center headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
lolcads tech blog
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/>Blog</a></li>
<li><a href=/about>About</a></li>
<li><a href=/contact>Contact</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/>Blog</a></li>
<li><a href=/about>About</a></li>
<li><a href=/contact>Contact</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=posts>
<div class="post on-list">
<h1 class=post-title>
<a href=https://lolcads.github.io/posts/2024/04/psscriptblockfragmentation/><em>PowerView</em> is evil, but <em>PowerVi</em> and <em>ew</em> are legit, right? - Missing signature-based detections due to PowerShell Script Block Logging Fragmentation</a>
</h1>
<div class=post-meta>
<span class=post-date>
2024-04-15
</span>
<span class=post-author>:: Louis Hackländer-Jansen</span>
</div>
<span class=post-tags>
#<a href=https://lolcads.github.io/tags/siem/>SIEM</a>&nbsp;
#<a href=https://lolcads.github.io/tags/threatdetection/>ThreatDetection</a>&nbsp;
#<a href=https://lolcads.github.io/tags/sigma/>Sigma</a>&nbsp;
#<a href=https://lolcads.github.io/tags/powershell/>PowerShell</a>&nbsp;
#<a href=https://lolcads.github.io/tags/scriptblocklogging/>ScriptBlockLogging</a>&nbsp;
#<a href=https://lolcads.github.io/tags/forensics/>Forensics</a>&nbsp;
</span>
<div class=post-content>
<a href=https://github.com/SigmaHQ/sigma>Sigma</a> offers more than 3000 rules for signature-based threat detection. 140 of these rules aim to detect suspicious/malicious PowerShell scripts by looking into PowerShell script block logs. Fragmentation of script blocks during Script Block Logging results in varying number of alerts when loading the same script multiple times. On the one hand, there is a trend of more alerts being generated when the script is split into more fragments (which is fine), but on the other hand, the fragmentation of scripts into blocks may result in missed detections.
</div>
<div>
<a class="read-more button" href=/posts/2024/04/psscriptblockfragmentation/>Read more →</a>
</div>
</div>
<div class=pagination>
<div class=pagination__buttons>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user">
<span>&copy; lolcads</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=https://lolcads.github.io/assets/main.js></script>
<script src=https://lolcads.github.io/assets/prism.js></script>
</div>
</body>
</html>